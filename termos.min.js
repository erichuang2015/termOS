!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t){t.exports={a:"0.0.1"}},function(t,e,n){"use strict";n.r(e);class r extends HTMLElement{constructor(){super(),this.constructor.isShadowed&&this.attachShadow({mode:"open"})}static get elementName(){throw new Error('Getter "elementName" must be implemented by subclasses.')}static get isShadowed(){return!0}static get styles(){return""}static define(t=this.elementName){if("string"!=typeof t)throw new Error(`String expected. ${typeof t} given.`);customElements.define(t,this)}get $host(){return this.constructor.isShadowed?this.shadowRoot:this}get $termOS(){let t=this;for(;;){if(t instanceof u)return t;if(t instanceof HTMLBodyElement)return null;t=t instanceof ShadowRoot?t.host:t.parentNode}}get isActive(){let t=document.activeElement;if(t===this)return!0;for(;t&&t.shadowRoot;)if((t=t.shadowRoot.activeElement)===this)return!0;return!1}prependStyles(t){if("string"!=typeof t)throw new Error(`String expected. ${typeof t} given.`);if(this.constructor.isShadowed||(t=t.replace(/:host/g,this.constructor.elementName)),!this.firstChild)return this.appendStyles(t);let e=document.createElement("style");e.textContent=t,this.insertBefore(e,this.firstChild)}appendStyles(t){if("string"!=typeof t)throw new Error(`String expected. ${typeof t} given.`);this.constructor.isShadowed||(t=t.replace(/:host/g,this.constructor.elementName));let e=document.createElement("style");e.textContent=t,this.$host.appendChild(e)}dispatchCustomEvent(t,e=null,n={}){if("string"!=typeof t)throw new Error(`String expected. ${typeof t} given.`);if("object"!=typeof n)throw new Error(`Object expected. ${typeof n} given.`);n.detail=e;let r=new CustomEvent(t,n);this.dispatchEvent(r)}show(){return this.style.display=null,this}hide(){return this.style.display="none",this}onFocus(t){}onFocusOut(t){}afterConnectedCallback(){return this}connectedCallback(){if(this.appendStyles(this.constructor.styles),!this.$termOS)throw this.remove(),new Error(`${this.constructor.elementName} must be a child of ${u.elementName}.`);return this.addEventListener("focus",t=>this.onFocus(t)),this.addEventListener("focusout",t=>this.onFocusOut(t)),setTimeout(()=>this.afterConnectedCallback(),1),this}disconnectedCallback(){return this}}class i{constructor(){}static get aliases(){return[]}static get paramsAliases(){return{}}static get help(){return""}static get man(){return""}static register(t=!1){c.registerCommand(new this,t)}get name(){throw new Error('Getter "name" must be implemented by subclasses.')}parseInput(t){if("string"!=typeof t)throw new Error(`String expected. ${typeof t} given.`);let e={};if(!(t=t.split(" ").filter(t=>!!t)).length)return e;let n,r,i=0;return t.map(t=>{n=void 0,r=void 0,0===t.indexOf("--")?-1===(t=t.replace("--","")).indexOf("=")?(n=t,r=!0):(n=t.substr(0,t.indexOf("=")),r=t.substr(t.indexOf("=")+1)||!0):0===t.indexOf("-")?(t=t.replace("-",""),n=t.substr(0,1),r=t.substr(1)||!0,this.constructor.paramsAliases.hasOwnProperty(n)&&(n=this.constructor.paramsAliases[n])):t&&(n=i++,r=t),void 0!==n&&void 0!==r&&(e[n]=r)}),e}run(t,e,n){throw new Error('Method "run" must be implemented by subclasses.')}}var s=n(0),o=Object.freeze({color:{background:"#000000",text:"#ffffff",red:"#d50000",green:"#00c853",blue:"#2962ff",orange:"#ff6d00"}});class c extends r{constructor(){super(),this.history=[]}static get OUTPUT_TYPES(){return Object.freeze({COMMON:"COMMON",INFO:"INFO",SUCCESS:"SUCCESS",WARN:"WARN",ERROR:"ERROR"})}static get welcomeMessage(){return this._welcomeMessage||(this._welcomeMessage=(()=>`terminalOS v${s.a}\n\n`)),this._welcomeMessage}static set welcomeMessage(t){if("string"!=typeof t&&"function"!=typeof t)throw new Error(`String or function expected. ${typeof t} given.`);if("string"==typeof t){let e=t;t=(()=>e)}this._welcomeMessage=t}static get commands(){return this.constructor._commands||(this.constructor._commands={}),this.constructor._commands}static get elementName(){return"term-os-terminal"}static get styles(){return super.styles+`\n            :host {\n                display: flex;\n                background: ${o.color.background};\n                color: ${o.color.text};\n            }\n        \n            :host ul {\n                flex: 1;\n                margin: 24px;\n                padding: 0;\n                list-style: none;\n                white-space: pre-wrap;\n                font-family: 'Roboto Mono', monospace;\n                user-select: text;\n                overflow: hidden scroll;\n            }\n            \n            :host ul:focus {\n                outline: none;\n            }\n            \n            :host ul::-webkit-scrollbar {\n                display: none;\n            }\n            \n            :host ul li {\n                font-size: 1.25em;\n            }\n            \n            :host ul li.INFO {\n                color: ${o.color.blue};\n            }\n            \n            :host ul li.SUCCESS {\n                color: ${o.color.green};\n            }\n            \n            :host ul li.WARN {\n                color: ${o.color.orange};\n            }\n            \n            :host ul li.ERROR {\n                color: ${o.color.red};\n            }\n            \n            :host ul li.input {\n                outline: none;\n                caret-color: transparent;\n            }\n            \n            :host ul li.input::before {\n                content: attr(data-prompt);\n                margin-right: 2px;\n            }\n            \n            :host ul li.input:last-child:focus::after {\n                content: '\\005f';\n                margin-left: 2px;\n                animation: cursor .8s linear infinite;\n            }\n            \n            :host ul li.input.cursored:last-child:focus {\n                caret-color: inherit;\n            }\n            \n            :host ul li.input.cursored:last-child:focus::after {\n                display: none;\n            }\n            \n            @keyframes cursor {\n                0%, 100% {\n                    opacity: 0;\n                }\n                50% {\n                    opacity: 1;\n                }\n            }\n        `}static registerCommand(t,e=!1){if(!(t instanceof i))throw new Error(`${i.name} expected. ${typeof t} given.`);let n=t.name.trim().toLocaleLowerCase();if(!e&&this.commands.hasOwnProperty(n))throw new Error(`Command "${n}" already registered.`);this.commands[n]=t,t.constructor.aliases.length&&(e||t.constructor.aliases.map(t=>{if(t=t.trim().toLowerCase(),this.commands.hasOwnProperty(t))throw new Error(`Alias "${t}" for command "${n}" is unacceptable.`)}),t.constructor.aliases.map(e=>this.commands[e.trim().toLowerCase()]=t))}get $io(){return this.$host.querySelector("ul")}get $activeInput(){return this.$io.querySelector(".input:last-child")}get isActive(){let t=super.isActive;return t||(t=this.$activeInput===document.activeElement),t}static createInput(t=null,e="> ",n=null){let r=document.createElement("li");if(r.className="input","string"!=typeof e)throw new Error(`String expected. ${typeof e} given.`);if(r.setAttribute("data-prompt",e),t){if("string"!=typeof t)throw new Error(`String expected. ${typeof t} given.`);r.innerText=t}if(n){if("function"!=typeof n)throw new Error(`Function expected. ${typeof n} given.`);r.callback=n}return r}static createOutput(t=null,e=this.OUTPUT_TYPES.COMMON){let n=document.createElement("li");if(t){if("string"!=typeof t)throw new Error(`String expected. ${typeof t} given.`);n.innerText=t}if(-1===Object.values(this.OUTPUT_TYPES).indexOf(e))throw new Error(`Unknown output type "${e}".`);return n.className=e,n}newLine(t,e){return this.$io.appendChild(this.constructor.createInput(t,e)),this}print(t,e=!0,n=this.constructor.OUTPUT_TYPES.COMMON){return this.$io.appendChild(this.constructor.createOutput(t,n)),e&&this.newLine(),this}clear(t=!0){return this.isActive&&this.focus(),this.$io.innerText="",t&&this.newLine(),this}exec(){let t=this.$activeInput.innerText;if("function"==typeof this.$activeInput.callback)return this.$activeInput.callback(t,this,this.$termOS);if(!t)return this.newLine(),!1;let e=t.split(" ").shift().trim().toLowerCase();this.history.push(t);let n=!1;if(Object.keys(this.constructor.commands).map(r=>{if(!n&&e===r){try{this.constructor.commands[e].run(t,this,this.$termOS)}catch(t){throw console.error(t),new Error(`${r} throw an error. See log for more info.`)}n=!0}}),!n)throw new Error(`Unknown command "${t}".`);return n}scrollToBottom(){return this.$io.scrollTop=this.$io.scrollHeight,this}focusToEnd(){let t=document.createRange(),e=window.getSelection();return t.selectNodeContents(this.$activeInput),t.collapse(!1),e.removeAllRanges(),e.addRange(t),this}suggestCommand(t){if("string"!=typeof t)throw new Error(`String expected. ${typeof t} given.`);return t=t.trim().toLowerCase(),Object.keys(this.constructor.commands).filter(e=>0===e.indexOf(t))}suggest(){if(!this.$activeInput)return this;let t=this.$activeInput.innerText;if(!t)return this;let e=t.split(" ").filter(t=>!!t),n=e.pop(),r=[];return Object.assign(r,this.suggestCommand(n)),1===r.length?(e.push(r[0]),this.$activeInput.innerText=e.join(" ").trim()+" "):r.length>0&&(this.print(r.join(" ".repeat(4)),!1),e.push(n),this.newLine(e.join(" ").trim())),this.focusToEnd(),this}historyUp(){let t=parseInt(this.$activeInput.getAttribute("historyindex"));this.history[t-1]&&(this.$activeInput.innerText=this.history[--t],this.$activeInput.setAttribute("historyindex",t),this.focusToEnd())}historyDown(){let t=parseInt(this.$activeInput.getAttribute("historyindex"));if(!this.history[t+1])return this.$activeInput.innerText="",void this.$activeInput.setAttribute("historyindex",this.history.length.toString());this.$activeInput.innerText=this.history[++t],this.$activeInput.setAttribute("historyindex",t),this.focusToEnd()}onIOMutation(t,e){let n=this.isActive;for(let e of t)"childList"===e.type&&(this.$io.querySelectorAll(".input").forEach(t=>{t.contentEditable="false"}),this.$activeInput&&(this.$activeInput.setAttribute("historyindex",this.history.length.toString()),this.$activeInput.contentEditable="true",n&&this.$activeInput.focus()))}onMouseUp(t){window.getSelection().toString()&&document.execCommand("copy"),this.$activeInput?this.$activeInput.focus():this.focus()}onIOKeyDown(t){let e=this.$activeInput&&"function"==typeof this.$activeInput.callback;switch(t.code){case"Enter":if(t.target===this.$activeInput){t.preventDefault();try{this.exec()}catch(t){this.print(t.message,!0,this.constructor.OUTPUT_TYPES.ERROR)}return!1}break;case"Tab":if(t.target===this.$activeInput)return t.preventDefault(),!e&&(this.suggest(),!1);break;case"ArrowLeft":case"ArrowRight":if(t.target===this.$activeInput)return this.$activeInput.classList.add("cursored"),!0;break;case"ArrowUp":if(t.target===this.$activeInput)return t.preventDefault(),!e&&(this.historyUp(),!1);break;case"ArrowDown":if(t.target===this.$activeInput)return t.preventDefault(),!e&&(this.historyDown(),!1);break;case"KeyK":case"KeyL":if(t.metaKey||t.ctrlKey)return t.preventDefault(),!e&&(this.clear(),!1);break;case"KeyC":if(t.metaKey||t.ctrlKey)return t.preventDefault(),!e&&(this.newLine(),!1)}}connectedCallback(){super.connectedCallback(),this.tabIndex=-1;let t=document.createElement("ul");return this.$host.appendChild(t),this.addEventListener("mouseup",t=>this.onMouseUp(t)),new MutationObserver((t,e)=>this.onIOMutation(t,e)).observe(this.$io,{childList:!0}),this.$io.addEventListener("keydown",t=>this.onIOKeyDown(t)),this.constructor.welcomeMessage&&this.print(this.constructor.welcomeMessage(),!1,this.constructor.OUTPUT_TYPES.SUCCESS),this.newLine(),this}}c.define();class a{static get STATE_STOP(){return-1}static get STATE_CLEAR(){return 0}static get STATE_IDLE(){return 1}static get STATE_WAITING(){return 2}static get STATE_TYPING(){return 100}static get STATE_DELETING(){return 200}static get TIMEOUT_IDLE(){return 100}static get TIMEOUT_TYPING(){return 100}static get TIMEOUT_DELETING(){return 50}constructor(t){if(!(t instanceof c))throw new Error(`${c.name} expected. ${typeof t} given.`);this._$terminal=t;let e=document.createElement("style");e.innerText="\n            :host main ul li.input.typer::before {\n                content: '\\002d\\00a0';\n            }\n        ",this._$terminal.shadowRoot.appendChild(e),this._timeout=this.constructor.TIMEOUT_IDLE,this._state=this.constructor.STATE_IDLE,this._typingText=[],this._queue=[],this._tick()}stop(){return this._state=this.constructor.STATE_STOP,this}clear(){return this._queue=[],this._state=this.constructor.STATE_CLEAR,this}idle(){return this._timeout=this.constructor.TIMEOUT_IDLE,this._state=this.constructor.STATE_IDLE,this}wait(t){return this._queue.push(()=>{this._timeout=t,this._state=this.constructor.STATE_WAITING}),this}type(t,e=1){if("string"!=typeof t)throw new Error(`String expected. ${typeof t} given.`);if("number"!=typeof e)throw new Error(`Number expected. ${typeof e} given.`);do{this._queue.push(()=>{this._timeout=this.constructor.TIMEOUT_TYPING,this._state=this.constructor.STATE_TYPING,this._typingText=t.toString().split("")})}while(--e>0);return this}delete(){return this._queue.push(()=>{this._timeout=this.constructor.TIMEOUT_DELETING,this._state=this.constructor.STATE_DELETING}),this}callback(t){if("function"!=typeof t)throw new Error(`Function expected. ${typeof t} given.`);return this._queue.push(()=>{t()}),this}_next(){this._queue.length?this._queue.shift()():this.idle()}_tick(){let t=this._$terminal.$activeInput;switch(this._state){case this.constructor.STATE_STOP:return void this._$terminal.idle();case this.constructor.STATE_CLEAR:case this.constructor.STATE_IDLE:case this.constructor.STATE_WAITING:this._$terminal.idle(),this._next();break;case this.constructor.STATE_TYPING:if(this._$terminal.busy(),!t)break;if(0===this._typingText.length){this._next();break}t.classList.add("typer");let e=this._typingText.shift();switch(e){case"\b":t.innerHTML=t.innerHTML.substr(0,t.innerHTML.length-1);break;case"\t":this._$terminal.suggest();break;case"\r":this._$terminal.print(this._typingText.join("")),this._typingText=[];break;case"\n":try{this._$terminal.exec()}catch(t){this._$terminal.newLine()}break;default:t.innerHTML=t.innerHTML+e}this._timeout=this.constructor.TIMEOUT_TYPING-Math.round(15*Math.random());break;case this.constructor.STATE_DELETING:if(this._$terminal.busy(),!t)break;if(0===t.innerHTML.length){this._next();break}t.innerHTML=t.innerHTML.substr(0,t.innerHTML.length-1)}this._$terminal.scrollToBottom(),setTimeout(this._tick.bind(this),this._timeout)}}(class extends i{static get help(){return"Clear the terminal screen."}get name(){return"clear"}run(t,e,n){e.clear()}}).register();(class extends i{static get help(){return"Display list of registered commands."}get name(){return"commands"}run(t,e,n){let r=Object.keys(e.constructor.commands);e.print(r.sort().join(", "),!0,e.constructor.OUTPUT_TYPES.INFO)}}).register();(class extends i{static get help(){return'Display helpful information about terminal commands. Type "help %command%" for more info.'}get name(){return"help"}run(t,e,n){let r=this.parseInput(t.split(" ").slice(1).join(" "));if(!r[0]||"string"!=typeof r[0])return void e.print('Type "help %command%" for more info.',!0,e.constructor.OUTPUT_TYPES.INFO);if(!e.constructor.commands.hasOwnProperty(r[0]))return void e.print(`Unknown command "${r[0]}".`,!0,e.constructor.OUTPUT_TYPES.ERROR);let i=e.constructor.commands[r[0]];i.constructor.help?e.print(i.constructor.help,!0,e.constructor.OUTPUT_TYPES.INFO):e.print(`Help for command "${i.name}" is not provided.`,!0,e.constructor.OUTPUT_TYPES.WARN)}}).register();(class extends i{static get help(){return"Reboot the entire system."}get name(){return"reboot"}run(t,e,n){e.print("rebooting...",!1,e.constructor.OUTPUT_TYPES.WARN),window.location.reload()}}).register();class u extends r{static get elementName(){return"term-os"}static get styles(){return super.styles+`\n            :host {\n                height: 100%;\n                width: 100%;\n                display: flex;\n                flex-direction: column;\n                user-select: none;\n            }\n            \n            :host ${c.elementName} {\n                flex: 1;\n            }\n        `}connectedCallback(){super.connectedCallback();let t=new c;this.$host.appendChild(t),t.focus()}}u.define(),n.d(e,"TermOS",function(){return u}),n.d(e,"TerminalModule",function(){return c}),n.d(e,"Command",function(){return i}),n.d(e,"TerminalTyper",function(){return a})}]);